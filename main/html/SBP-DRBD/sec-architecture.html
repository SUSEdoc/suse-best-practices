<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Cluster Architecture Overview</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.2" /><style type="text/css">
body { background-image: url('static/images/draft.png');
       background-repeat: no-repeat;
       background-position: top left;
       /* The following properties make the watermark "fixed" on the page. */
       /* I think that's just a bit too distracting for the reader... */
       /* background-attachment: fixed; */
       /* background-position: center center; */
     }</style><link rel="home" href="index.html" title="Data Replication across Geo Clusters via DRBD" /><link rel="up" href="index.html" title="Data Replication across Geo Clusters via DRBD" /><link rel="prev" href="sec-installation.html" title="Installation Requirements" /><link rel="next" href="sec-example-config.html" title="Example Configurations for a Single Service" /></head><body onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Cluster Architecture Overview</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="sec-installation.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="sec-example-config.html">Next</a></td></tr></table><hr /></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="sec-architecture"></a>Cluster Architecture Overview</h2></div></div></div><p>The following image depicts a two-site, four-node cluster with arrows showing the
            direction of replication, and blocks in orange showing that a DRBD device is Primary.
            There are two nodes in the local site, <span class="italic">alice</span> and
                <span class="italic">bob</span>, and two nodes in the remote site, <span class="italic">charlie</span> and <span class="italic">daisy</span>.</p><p>Each site will have its own DRBD resource stack and service IP to allow independent
            migration across the cluster nodes.</p><div class="figure"><a id="id1338"></a><p class="title"><strong>Figure 1. Stacked Four-Node Cluster</strong></p><div class="figure-contents"><div class="mediaobject"><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="70%"><tr><td><img src="images/drbd-resource-stacking-4nodes.png" width="100%" alt="Stacked Four-Node Cluster" /></td></tr></table></div></div></div><br class="figure-break" /><p>The most important details of the cluster architecture are the following:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>The local high availability setup: DRBD running in Protocol C, using IP
                    addresses in a LAN respective a cross-over connection.</p></li><li class="listitem"><p>Just after activating the lower DRBD devices on one node, the dedicated
                    service IP address is started.</p><p>This is not only used for the service as such, but also as a fixed point that
                    can be accessed by the upper DRBD device (in Secondary state) for
                    replication.</p></li><li class="listitem"><p>The upper layer DRBD runs on one node per site, and is responsible for
                    replicating the data to the other replication site. This connection runs in
                    protocol A, and might have a DRBD Proxy setup in between.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Data Compression</h3><p>The DRBD Proxy buffers and optionally compresses data, from one or
                        multiple DRBD resources. Compression helps if the site interconnect is
                        slower than the summed average I/O rate of the resources. The ratio is about
                        1:4 for <span class="strong"><strong>zlib</strong></span>, and up to 1:50 for
                            <span class="strong"><strong>lzma</strong></span> compression. See the <span class="quote">“<span class="quote">DRBD
                            Proxy 3 Compression Considerations</span>”</span> whitepaper on <a class="link" href="https://links.linbit.com/tech_guides" target="_top">https://links.linbit.com/tech_guides</a> for more
                        details.</p></div></li><li class="listitem"><p>On the site that should actually run the service, the upper layer DRBD gets
                    set as Primary, so that the file system therein can be mounted and used by the
                    application.</p></li></ul></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="sec-installation.html">Prev</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="sec-example-config.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Installation Requirements </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Example Configurations for a Single Service</td></tr></table></div></body></html>
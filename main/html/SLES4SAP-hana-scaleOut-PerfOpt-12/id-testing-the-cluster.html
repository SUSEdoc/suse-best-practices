<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Testing the cluster</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.2" /><style type="text/css">
body { background-image: url('static/images/draft.png');
       background-repeat: no-repeat;
       background-position: top left;
       /* The following properties make the watermark "fixed" on the page. */
       /* I think that's just a bit too distracting for the reader... */
       /* background-attachment: fixed; */
       /* background-position: center center; */
     }</style><link rel="home" href="index.html" title="SAP HANA System Replication Scale-Out - Performance Optimized Scenario" /><link rel="up" href="index.html" title="SAP HANA System Replication Scale-Out - Performance Optimized Scenario" /><link rel="prev" href="id-configuring-the-cluster-and-sap-hana-resources.html" title="Configuring the cluster and SAP HANA resources" /><link rel="next" href="id-administration.html" title="Administration" /></head><body onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Testing the cluster</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="id-configuring-the-cluster-and-sap-hana-resources.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="id-administration.html">Next</a></td></tr></table><hr /></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id-testing-the-cluster"></a>Testing the cluster</h2></div></div></div><p><a id="Testing"></a>Testing is one of the most important project tasks for implementing clusters.
Proper testing is crucial. Make sure that all test cases
derived from project or customer expectations are defined and passed completely.
<span class="strong"><strong>Without testing the project is likely to fail in production use</strong></span>.</p><div class="figure"><a id="id2669"></a><p class="title"><strong>Figure 13. <a class="xref" href="id-planning-the-installation.html#Planning">[Planning]</a> <a class="xref" href="id-setting-up-the-operating-system.html#OsSetup">[OsSetup]</a> <a class="xref" href="id-installing-the-sap-hana-databases-on-both-sites.html#SAPHanaInst">[SAPHanaInst]</a> <a class="xref" href="id-setting-up-the-sap-hana-system-replication.html#SAPHanaHsr">[SAPHanaHsr]</a> <a class="xref" href="id-integrating-sap-hana-with-the-cluster.html#Integration">[Integration]</a> <a class="xref" href="id-configuring-the-cluster-and-sap-hana-resources.html#Cluster">[Cluster]</a> Testing</strong></p><div class="figure-contents"><div class="mediaobject"><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td><img src="images/SAPHanaSR-ScaleOut-Plan-Phase7.svg" width="100%" alt="SAPHanaSR ScaleOut Plan Phase7" /></td></tr></table></div></div></div><br class="figure-break" /><p>The test prerequisite, if not described differently, is always that all cluster
nodes are booted, are already normal members of the cluster and the SAP HANA RDBMS
is running. The system replication is in state <span class="strong"><strong>SYNC</strong></span> represented by 'SOK'.
The cluster is idle, no actions are pending, no migration constraints left over, no failcounts left over.</p><p>In the current version of this setup guide a plain list of test cases is provided. A more detailed description of the
test cases is planned for future versions. These details will be provided either in an updated version of this guide
or the test cases will be extracted to a separate test plan document.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id-generic-cluster-tests"></a>Generic cluster tests</h3></div></div></div><p>The cluster tests described in this section cover the cluster reaction during operations. This includes starting and stopping
the complete cluster or simulating SBD failures and much more.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Parallel start of all cluster nodes (<code class="literal">systemctl start pacemaker</code> should be done in a short time frame).</p></li><li class="listitem"><p>Stop of the complete cluster.</p></li><li class="listitem"><p>Isolate ONE of the two SAP HANA sites.</p></li><li class="listitem"><p>Power-off the majority maker.</p></li><li class="listitem"><p>Isolate the SBD.</p></li><li class="listitem"><p>Simulate a maintenance procedure with cluster continuously running.</p></li><li class="listitem"><p>Simulate a maintenance procedure with cluster restart.</p></li><li class="listitem"><p>Kill the corosync process of one of the cluster nodes.</p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id-tests-on-the-primary-site"></a>Tests on the primary site</h3></div></div></div><p>The tests described in this section are checking the reaction on several failures of the primary site.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id-tests-regarding-cluster-nodes-of-the-primary-site"></a>Tests regarding cluster nodes of the primary site</h4></div></div></div><p>The tests listed here check the SAP HANA and cluster reaction if one or more nodes of the primary site are failing or
re-joining the cluster.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Power-off master name server of the primary. The test assumes that there is still an SAP HANA standby instance.</p></li><li class="listitem"><p>Power-off master name server of the primary after all standby instances are already in use.</p></li><li class="listitem"><p>Power-off any worker node but not the master name server of the primary. The test assumes that there is still an SAP HANA standby instance.</p></li><li class="listitem"><p>Power-off any worker node but not the master name server of the primary after all standby instances are already in use.</p></li><li class="listitem"><p>Power-off any standby node of the primary.</p></li><li class="listitem"><p>Re-join of a previously power-off cluster node.</p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id-tests-regarding-the-complete-primary-site"></a>Tests regarding the complete primary site</h4></div></div></div><p>This test category is simulating a complete site failure.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Power-off all nodes of the primary site in parallel.</p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id-tests-regarding-the-sap-hana-instances-of-the-primary-site"></a>Tests regarding the SAP HANA instances of the primary site</h4></div></div></div><p>The tests listed here are checks about the SAP HANA and cluster reactions triggered by application failures such as a crashed SAP HANA instance.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Kill the SAP HANA instance of the master name server of the primary. The test assumes that there is still an SAP HANA standby instance.</p></li><li class="listitem"><p>Kill the SAP HANA instance of the master name server of the primary after all standby instances are already in use.</p></li><li class="listitem"><p>Kill the SAP HANA instance of any worker node but not the master name server of the primary. The test assumes that there is still an SAP HANA standby instance.</p></li><li class="listitem"><p>Kill the SAP HANA instance of any worker node but not the master name server of the primary after all standby instances are already in use.</p></li><li class="listitem"><p>Kill the SAP HANA instance of any standby node.</p></li><li class="listitem"><p>Kill sapstartsrv of any SAP HANA instance of the primary.</p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id-tests-on-the-secondary-site"></a>Tests on the secondary site</h3></div></div></div><p>The tests described in this section are checking the reaction on several failures of the secondary site.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id-tests-regarding-cluster-nodes-of-the-secondary-site"></a>Tests regarding cluster nodes of the secondary site</h4></div></div></div><p>The tests listed here check the SAP HANA and cluster reaction if one or more nodes of the secondary site are failing or
re-joining the cluster.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Power-off master name server of the secondary. The test assumes that there is still an SAP HANA standby instance.</p></li><li class="listitem"><p>Power-off master name server of the secondary after all standby instances are already in use.</p></li><li class="listitem"><p>Power-off any worker node but not the master name server of the secondary. The test assumes that there is still an SAP HANA standby instance.</p></li><li class="listitem"><p>Power-off any worker node but not the master name server of the secondary after all standby instances are already in use.</p></li><li class="listitem"><p>Power-off any standby node of the secondary.</p></li><li class="listitem"><p>Re-join of a previously power-off cluster node.</p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id-tests-regarding-the-complete-secondary-site"></a>Tests regarding the complete secondary site</h4></div></div></div><p>This test category is simulating a complete site failure.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Power-off all nodes of the secondary site in parallel.</p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="id-tests-regarding-the-sap-hana-instances-of-the-secondary-site"></a>Tests regarding the SAP HANA instances of the secondary site</h4></div></div></div><p>The tests listed here are checks about the SAP HANA and cluster reactions triggered by application failures such as a crashed SAP HANA instance.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Kill the SAP HANA instance of the master name server of the secondary. The test assumes that there is still an SAP HANA standby instance.</p></li><li class="listitem"><p>Kill the SAP HANA instance of the master name server of the secondary after all standby instances are already in use.</p></li><li class="listitem"><p>Kill the SAP HANA instance of any worker node but not the master name server of the secondary. The test assumes that there is still an SAP HANA standby instance.</p></li><li class="listitem"><p>Kill the SAP HANA instance of any worker node but not the master name server of the secondary after all standby instances are already in use.</p></li><li class="listitem"><p>Kill the SAP HANA instance of any standby node.</p></li><li class="listitem"><p>Kill <span class="emphasis"><em>sapstartsrv</em></span> of any SAP HANA instance of the secondary.</p></li></ul></div></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="id-configuring-the-cluster-and-sap-hana-resources.html">Prev</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="id-administration.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Configuring the cluster and SAP HANA resources </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Administration</td></tr></table></div></body></html>
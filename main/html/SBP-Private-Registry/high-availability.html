<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>High Availability</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.2" /><style type="text/css">
body { background-image: url('static/images/draft.png');
       background-repeat: no-repeat;
       background-position: top left;
       /* The following properties make the watermark "fixed" on the page. */
       /* I think that's just a bit too distracting for the reader... */
       /* background-attachment: fixed; */
       /* background-position: center center; */
     }</style><link rel="home" href="index.html" title="SUSE Private Registry Powered by Harbor 2.1" /><link rel="up" href="index.html" title="SUSE Private Registry Powered by Harbor 2.1" /><link rel="prev" href="requirements.html" title="Requirements" /><link rel="next" href="id-deployment-of-suse-private-registry.html" title="Deployment of SUSE Private Registry" /></head><body onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">High Availability</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="requirements.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="id-deployment-of-suse-private-registry.html">Next</a></td></tr></table><hr /></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="high-availability"></a>High Availability</h2></div></div></div><p>To install SUSE Private Registry with all high availability features fully enabled, or to be able to fully scale out an existing SUSE Private Registry deployment, the number of replicas for every registry component needs to be configured to 2 or more.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Use a ReplicaCount value of 2 or higher</p><p>The replica count can be configured in the Helm chart individually for every component.</p></li><li class="listitem"><p>HA Ingress Controller</p><p>If a Kubernetes Ingress controller is used to expose the SUSE Private Registry services, use a replica count value of 2 or higher for the ingress controller deployment.</p></li><li class="listitem"><p>Use external storage, or a <code class="literal">ReadWriteMany</code> access mode Kubernetes <code class="literal">StorageClass</code> to store OCI artifacts</p><p>If the SUSE Private Registry <code class="literal">registry</code> internal component is configured to use Kubernetes persistent volumes to store OCI artifacts instead of an external storage service such as Azure Blob Storage or Amazon S3, increasing the number of replicas is only possible if the Kubernetes <code class="literal">StorageClass</code> supports the <code class="literal">ReadWriteMany</code> access mode. High availability may be explicitly disabled only for this component, if such a <code class="literal">StorageClass</code> cannot be provided.</p></li><li class="listitem"><p><span class="strong"><strong>The internal database and redis component do not support high availability.</strong></span></p></li><li class="listitem"><p>Database can only be HA when SUSE Private Registry is connected to an external HA database setup</p><p>For the database component, the only supported way to achieve High Availability is to connect SUSE Private Registry to an external hosted database service, such as Amazon RDS/PostgreSQL or Azure Database for PostgreSQL, deployed in a highly available setup.
See <a class="xref" href="id-deployment-of-suse-private-registry.html#install-external-database">[install-external-database]</a> in the Deployment section.</p></li><li class="listitem"><p>To enable high availability for the Redis component, use one of the following:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>Connect to an external HA redis service (Azure Cache / Amazon ElastiCache)</p><p>Connect SUSE Private Registry to an external hosted redis service, such as Amazon ElastiCache for Redis or Azure Cache for Redis - deployed in a highly available setup. This is the equivalent to the database solution mentioned above.</p><p><span class="strong"><strong>or</strong></span></p></li><li class="listitem"><p>Install the SUSE Redis operator on the same cluster, as the de facto "external" redis service</p><p>Install a highly available Redis cluster via the SUSE Redis operator Helm chart into the same Kubernetes cluster where SUSE Private Registry is running, then connect the SUSE Private Registry to it as an external redis service.
Read more about installing Redis operator in the Deployment section.</p></li></ul></div></li></ul></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="requirements.html">Prev</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="id-deployment-of-suse-private-registry.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Requirements </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Deployment of SUSE Private Registry</td></tr></table></div></body></html>
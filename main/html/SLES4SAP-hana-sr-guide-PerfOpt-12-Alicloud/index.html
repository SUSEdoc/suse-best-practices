<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>SAP HANA High Availability Cross-Zone Solution on Alibaba Cloud</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.2" /><meta name="description" content="SUSE® Linux Enterprise Server for SAP Applications is optimized in various ways for SAP* applications. This document explains how to deploy an SAP HANA High Availability solution cross different Zones on Alibaba Cloud. It is based on SUSE Linux Enterprise Server for SAP Applications 12 SP2. The concept however can also be used with SUSE Linux Enterprise Server for SAP Applications 12 SP3 or newer. Disclaimer: Documents published as part of the SUSE Best Practices series have been contributed voluntarily by SUSE employees and third parties. They are meant to serve as examples of how particular actions can be performed. They have been compiled with utmost attention to detail. However, this does not guarantee complete accuracy. SUSE cannot verify that actions described in these documents do what is claimed or whether actions described have unintended consequences. SUSE LLC, its affiliates, the authors, and the translators may not be held liable for possible errors or the consequences thereof." /><style type="text/css">
body { background-image: url('static/images/draft.png');
       background-repeat: no-repeat;
       background-position: top left;
       /* The following properties make the watermark "fixed" on the page. */
       /* I think that's just a bit too distracting for the reader... */
       /* background-attachment: fixed; */
       /* background-position: center center; */
     }</style><link rel="home" href="index.html" title="SAP HANA High Availability Cross-Zone Solution on Alibaba Cloud" /><link rel="next" href="id-infrastructure-preparation.html" title="Infrastructure Preparation" /></head><body onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">SAP HANA High Availability Cross-Zone Solution on Alibaba Cloud</th></tr><tr><td width="20%" align="left"> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="id-infrastructure-preparation.html">Next</a></td></tr></table><hr /></div><div xml:lang="en" class="article" lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="id1337"></a>SAP HANA High Availability Cross-Zone Solution on Alibaba Cloud</h2></div><div><h3 class="subtitle"><em>With SUSE Linux Enterprise Server for SAP Applications</em></h3></div><div><div class="author"><h3 class="author"><span class="firstname">Jinhui</span> <span class="surname">Li, Product Manager SAP Solutions on Alibaba Cloud, AliCloud (Germany)</span></h3></div></div><div><div class="author"><h3 class="author"><span class="firstname">Bernd</span> <span class="surname">Schubert, SAP Solution Architect, SUSE</span></h3></div></div><div><div class="abstract"><p class="title"><strong>Abstract</strong></p><p>SUSE® Linux Enterprise Server for SAP Applications is
            optimized in various ways for SAP* applications.
            This document explains how to deploy an SAP HANA High Availability solution cross different Zones on
            <span class="strong"><strong>Alibaba Cloud</strong></span>. It is based on SUSE Linux Enterprise Server for
            SAP Applications 12 SP2. The concept however can also be used with
            SUSE Linux Enterprise Server for SAP Applications 12 SP3 or
            newer.</p><p><span class="strong"><strong>Disclaimer: </strong></span>
            Documents published as part of the SUSE Best Practices series have been contributed voluntarily
            by SUSE employees and third parties. They are meant to serve as examples of how particular
            actions can be performed. They have been compiled with utmost attention to detail.
            However, this does not guarantee complete accuracy. SUSE cannot verify that actions described
            in these documents do what is claimed or whether actions described have unintended consequences.
            SUSE LLC, its affiliates, the authors, and the translators may not be held liable for possible errors
            or the consequences thereof.</p></div></div></div><hr /></div><div class="toc"><p><strong>Table of Contents</strong></p><dl class="toc"><dt><span class="section"><a href="index.html#id-solution-overview">Solution Overview</a></span></dt><dd><dl><dt><span class="section"><a href="index.html#id-sap-hana-system-replication">SAP HANA System Replication</a></span></dt><dt><span class="section"><a href="index.html#id-high-availability-extension-included-with-suse-linux-enterprise-server-for-sap-applications">High Availability Extension Included with SUSE Linux Enterprise Server for SAP Applications</a></span></dt><dt><span class="section"><a href="index.html#id-architecture-overview">Architecture Overview</a></span></dt><dt><span class="section"><a href="index.html#id-network-design">Network Design</a></span></dt></dl></dd><dt><span class="section"><a href="id-infrastructure-preparation.html">Infrastructure Preparation</a></span></dt><dd><dl><dt><span class="section"><a href="id-infrastructure-preparation.html#id-infrastructure-list">Infrastructure List</a></span></dt><dt><span class="section"><a href="id-infrastructure-preparation.html#id-creating-vpc">Creating VPC</a></span></dt><dt><span class="section"><a href="id-infrastructure-preparation.html#id-creating-ecs-instances">Creating ECS Instances</a></span></dt><dt><span class="section"><a href="id-infrastructure-preparation.html#id-creating-enis-and-binding-to-ecs-instances">Creating ENIs and Binding to ECS Instances</a></span></dt><dt><span class="section"><a href="id-infrastructure-preparation.html#id-creating-nat-gateway-and-configure-snat-entry">Creating NAT Gateway and configure SNAT entry</a></span></dt><dt><span class="section"><a href="id-infrastructure-preparation.html#id-creating-stonith-device-and-virtual-ip-resource-agent">Creating STONITH Device and Virtual IP Resource Agent</a></span></dt></dl></dd><dt><span class="section"><a href="id-software-preparation.html">Software Preparation</a></span></dt><dd><dl><dt><span class="section"><a href="id-software-preparation.html#id-software-list">Software List</a></span></dt><dt><span class="section"><a href="id-software-preparation.html#id-high-availability-extension-installation">High Availability Extension Installation</a></span></dt><dt><span class="section"><a href="id-software-preparation.html#id-sap-hana-installation">SAP HANA Installation</a></span></dt><dt><span class="section"><a href="id-software-preparation.html#id-sap-host-agent-installation">SAP Host Agent Installation</a></span></dt></dl></dd><dt><span class="section"><a href="id-configuring-sap-hana-system-replication.html">Configuring SAP HANA System Replication</a></span></dt><dd><dl><dt><span class="section"><a href="id-configuring-sap-hana-system-replication.html#id-backing-up-sap-hana-on-primary-ecs-instance">Backing up SAP HANA on Primary ECS Instance</a></span></dt><dt><span class="section"><a href="id-configuring-sap-hana-system-replication.html#id-configuring-sap-hana-system-replication-on-primary-node">Configuring SAP HANA System Replication on Primary Node</a></span></dt><dt><span class="section"><a href="id-configuring-sap-hana-system-replication.html#id-configuring-sap-hana-system-replication-on-secondary-node">Configuring SAP HANA System Replication on Secondary Node</a></span></dt><dt><span class="section"><a href="id-configuring-sap-hana-system-replication.html#id-enable-sap-hana-system-replication-on-primary-node">Enable SAP HANA System Replication on Primary Node</a></span></dt><dt><span class="section"><a href="id-configuring-sap-hana-system-replication.html#id-register-the-secondary-node-to-the-primary-sap-hana-node">Register the Secondary Node to the Primary SAP HANA Node</a></span></dt></dl></dd><dt><span class="section"><a href="id-configuring-high-availability-extension-for-sap-hana.html">Configuring High Availability Extension for SAP HANA</a></span></dt><dd><dl><dt><span class="section"><a href="id-configuring-high-availability-extension-for-sap-hana.html#id-configuration-of-corosync">Configuration of Corosync</a></span></dt><dt><span class="section"><a href="id-configuring-high-availability-extension-for-sap-hana.html#id-configuration-of-pacemaker">Configuration of Pacemaker</a></span></dt><dt><span class="section"><a href="id-configuring-high-availability-extension-for-sap-hana.html#id-check-the-cluster-status">Check the Cluster Status</a></span></dt><dt><span class="section"><a href="id-configuring-high-availability-extension-for-sap-hana.html#id-verify-the-high-availability-takeover">Verify the High Availability Takeover</a></span></dt></dl></dd><dt><span class="section"><a href="id-example.html">Example</a></span></dt><dd><dl><dt><span class="section"><a href="id-example.html#id-example-of-cluster-configuration">Example of Cluster Configuration</a></span></dt><dt><span class="section"><a href="id-example.html#id-example-of-etccorosynccorosync-conf">Example of /etc/corosync/corosync.conf</a></span></dt></dl></dd><dt><span class="section"><a href="id-reference.html">Reference</a></span></dt><dt><span class="section"><a href="id-legal-notice.html">Legal Notice</a></span></dt><dt><span class="section"><a href="id-gnu-free-documentation-license.html">GNU Free Documentation License</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id-solution-overview"></a>Solution Overview</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id-sap-hana-system-replication"></a>SAP HANA System Replication</h3></div></div></div><p>SAP HANA provides a feature called <span class="strong"><strong>System Replication</strong></span> which is available in every SAP HANA installation. It offers an inherent disaster recovery support.</p><p>For details, refer to the SAP Help Portal, HANA system replication:</p><p><a class="link" href="https://help.sap.com/viewer/6b94445c94ae495c83a19646e7c3fd56/2.0.03/en-US/b74e16a9e09541749a745f41246a065e.html" target="_top">https://help.sap.com/viewer/6b94445c94ae495c83a19646e7c3fd56/2.0.03/en-US/b74e16a9e09541749a745f41246a065e.html</a>.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id-high-availability-extension-included-with-suse-linux-enterprise-server-for-sap-applications"></a>High Availability Extension Included with SUSE Linux Enterprise Server for SAP Applications</h3></div></div></div><p>The SUSE High Availability Extension is a high availability solution based on Corosync and Pacemaker. With SUSE Linux Enterprise Server for SAP Applications, SUSE provides SAP specific Resource Agents (SAPHana, SAPHanaTopology etc.) used by Pacemaker. This helps you to build your SAP HANA HA solution up more effectively.</p><p>For details, refer to the latest version of the document <span class="strong"><strong>SAP HANA SR Performance Optimized Scenario</strong></span> at the SUSE documentation Web page:</p><p><a class="link" href="https://documentation.suse.com/sbp/sap/" target="_top">https://documentation.suse.com/sbp/sap/</a></p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id-architecture-overview"></a>Architecture Overview</h3></div></div></div><p>This document guides you on how to deploy an SAP HANA High Availability (HA) solution cross different Zones. The following list contains a brief architecture overview:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>The High Availability Extension included with SUSE Linux Enterprise Server for SAP Applications is used to set up the HA Cluster;</p></li><li class="listitem"><p>SAP HANA System Replication is activated between the two HANA nodes;</p></li><li class="listitem"><p>Two HANA nodes are located in different Zones of the same Region;</p></li><li class="listitem"><p>The Alibaba Cloud Specific Virtual IP Resource Agent is used to allow Moving IP automatically switched to Active SAP HANA node; the Alibaba Cloud specific STONITH device is used for fencing.</p></li></ol></div><p>Alibaba Cloud Architecture - Overview:</p><div class="informalfigure"><div class="mediaobject"><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="60%"><tr><td><img src="images/Alicloud_image001.png" width="100%" alt="arch" /></td></tr></table></div></div><p>Network Architecture - Overview:</p><div class="informalfigure"><div class="mediaobject"><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="60%"><tr><td><img src="images/Alicloud_network.png" width="100%" alt="network" /></td></tr></table></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id-network-design"></a>Network Design</h3></div></div></div><p>The following table contains information for the Network design.</p><div class="informaltable"><table class="informaltable" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /><col class="col_4" /><col class="col_5" /></colgroup><tbody><tr><td align="left" valign="top"><p>hostname</p></td><td align="left" valign="top"><p>role</p></td><td align="left" valign="top"><p>heartbeat IP</p></td><td align="left" valign="top"><p>business IP</p></td><td align="left" valign="top"><p>virtual IP</p></td></tr><tr><td align="left" valign="top"><p>hana0</p></td><td align="left" valign="top"><p>HANA primary node</p></td><td align="left" valign="top"><p>192.168.0.83</p></td><td align="left" valign="top"><p>192.168.0.82</p></td><td rowspan="2" align="left" valign="top"><p>192.168.4.1</p></td></tr><tr><td align="left" valign="top"><p>hana1</p></td><td align="left" valign="top"><p>HANA secondary node</p></td><td align="left" valign="top"><p>192.168.1.246</p></td><td align="left" valign="top"><p>192.168.1.245</p></td></tr><tr><td align="left" valign="top"><p>HANAStudio</p></td><td align="left" valign="top"><p>HANA Studio</p></td><td align="left" valign="top"><p>no</p></td><td align="left" valign="top"><p>192.168.0.79</p></td><td align="left" valign="top"><p>no</p></td></tr></tbody></table></div></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="id-infrastructure-preparation.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top"> </td><td width="20%" align="center"> </td><td width="40%" align="right" valign="top"> Infrastructure Preparation</td></tr></table></div></body></html>